<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>login</title>
  <script language='javascript'>
    var t;
    function doLoad() {
      if(window.opener === null) {
        const urlParams = new URLSearchParams(window.location.search);
        window.history.replaceState(
          { code: urlParams.get('code'),
          verifier: urlParams.get('state')},
          '',
          window.location.origin + "/index.html",
        );
        window.location = window.location.origin + "/index.html";
      } else {
        t = setTimeout("window.close()",1000);
      }
    }
    function refreshAndClose() {
      const urlParams = new URLSearchParams(window.location.search);
      if(window.opener!== null) {
        window.opener.history.replaceState(
          { code: urlParams.get('code'),
          verifier: urlParams.get('state') },
          '',
          window.location.origin + "/index.html",
        );
          window.opener.location.reload(true);
          window.close();
      }
    }
    </script>
</head>

  <body onbeforeunload="refreshAndClose();" onLoad='doLoad()''></body>
</html>